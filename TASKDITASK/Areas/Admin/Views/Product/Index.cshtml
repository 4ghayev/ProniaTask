@model List<Product>

<div class="container">
    <div class="row">

        <div class="row">
            <div class="col-4"><h2>Products</h2></div>
            <div class="col-2">
                <a class="btn btn-success" asp-action="Create">Create</a>
            </div>
        </div>

        <table class="table table-striped table-dark">
            <thead>
                <tr>
                    <th>Id</th>
                    <th>Name</th>
                    <th>Description</th>
                    <th>Image</th>
                    <th>Price</th>
                    <th>Category</th>
                    <th>Actions</th>
                </tr>
            </thead>

            <tbody>
                @foreach (Product product in Model)
                {
                    <tr>
                        <td>@product.Id</td>
                        <td>@product.Name</td>
                        <td>@product.Description</td>
                        <td>
                            <img src="~/assets/images/website-images/@product.ImagePath"
                                 width="30" height="30" />
                        </td>
                        <td>@product.Price</td>
                        <td>@product.Category.Name</td>
                        <td>
                            <a class="btn btn-warning"
                               asp-action="Update"
                               asp-route-id="@product.Id">
                                Update
                            </a>

                            <button class="btn btn-danger"
                                    onclick="deleteProduct(@product.Id)">
                                Delete
                            </button>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script>
    function deleteProduct(id) {
        Swal.fire({
            title: 'Əminsən?',
            text: 'Bu məhsul silinəcək!',
            icon: 'warning',
            showCancelButton: true,
            confirmButtonText: 'Bəli',
            cancelButtonText: 'Xeyr'
        }).then((result) => {
            if (result.isConfirmed) {
                fetch('/Admin/Product/Delete/' + id, {
                    method: 'POST'
                })
                .then(() => {
                    Swal.fire(
                        'Silindi!',
                        'Məhsul uğurla silindi.',
                        'success'
                    ).then(() => location.reload());
                });
            }
        });
    }
</script>
